<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Homepage Test</title>
		<link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css' />
		<link href='/css/template.css' rel="stylesheet" />
		<script src="/bower_components/angular/angular.js"></script>
	</head>
	<body ng-app="templateApp">
		<h1>Kommissioner</h1>
		
		<div class="commission-panel" ng-controller="templateController">
      <h2>Commissions</h2>
      
      <div class="commissions-list active-commissions-list">
        <h3>Active Commissions</h3>
        <div class="commissions-list-toggle active-commissions-list-toggle"></div>
        <ul ng-if="activeCommissionListDisclosed">
          <li class="commission active-commission" ng-class="{ 'commission-with-unread-messages': commission.unreadMessageCount > 0, 'selected-commission': $index == selectedCommissionIndex }" ng-repeat="commission in commissions  | filter: { status: 'active' }">
            <div class="person-image" ng-class="{ 'person-image-generic': !commission.buyer.image }">
              <img ng-if="commission.buyer.image" ng-src="{{ commission.buyer.image }}">
            </div>
            <h4>{{ commission.title }}</h4>
            <p>{{ commission.buyer.name }}</p>
          </li>
        </ul>
      </div>
      
      <div class="commissions-list active-commissions-list">
        <h3>Requests</h3>
        <div class="commissions-list-toggle request-commissions-list-toggle"></div>
        <ul ng-if="requestCommissionListDisclosed">
          <li class="commission active-commission" ng-class="{ 'commission-with-unread-messages': commission.unreadMessageCount > 0 }" ng-repeat="commission in commissions  | filter: { status: 'request' }">
            <div class="person-image" ng-class="{ 'person-image-generic': !commission.buyer.image }">
              <img ng-if="commission.buyer.image" ng-src="{{ commission.buyer.image }}">
            </div>
            <h4>{{ commission.title }}</h4>
            <p>{{ commission.buyer.name }}</p>
          </li>
        </ul>
      </div>
      
      <div class="commissions-list active-commissions-list">
        <h3>Completed</h3>
        <div class="commissions-list-toggle completed-commissions-list-toggle"></div>
        <ul ng-if="completedCommissionListDisclosed">
          <li class="commission active-commission" ng-class="{ 'commission-with-unread-messages': commission.unreadMessageCount > 0 }" ng-repeat="commission in commissions  | filter: { status: 'completed' }">
            <div class="person-image" ng-class="{ 'person-image-generic': !commission.buyer.image }">
              <img ng-if="commission.buyer.image" ng-src="{{ commission.buyer.image }}">
            </div>
            <h4>{{ commission.title }}</h4>
            <p>{{ commission.buyer.name }}</p>
          </li>
        </ul>
      </div>
      
		</div>

		
		<script src="/bower_components/jquery/jquery.js"></script>
    <script>
      var templateApp = angular.module('templateApp', []);
      
      var controller = templateApp.controller('templateController', function($scope) {
        $scope.activeCommissionListDisclosed = true;
        $scope.requestCommissionListDisclosed = true;
        $scope.completedCommissionListDisclosed = false;
        
        $scope.selectedCommissionIndex = 0;
        
        $scope.commissions = [
          {
            title: 'DRAW MAH OC',
            buyer: { 
              name: 'PippySmudgebutt', 
              image: 'example_images/pippy.png' 
            },
            unreadMessageCount: 0,
            lastUpdated: new Date(2014, 1, 23),
            price: 7.00,
            status: 'active',
            addons: [
              {
                name: '+ 1 additional character',
                price: 12.00
              }
            ],
            messages: [
              {
                from: 'Roman Razor',
                date: new Date(2014, 1, 23),
                body: 'Yeah, sure',
                attachments: []
              },
              {
                from: 'Pippy Smudgebutt',
                date: new Date(2014, 1, 23),
                body: "Hey There,\n Can I commission you to do a thing? Ref attached.\n- Pippy",
                read: true,
                attachments: [
                  {
                    name: 'Smudebutt-ref.jpg',
                    size: 249,
                  }
                ]
              }
            ]
          },
          {
            title: 'Commission Title Here',
            buyer: { name: 'John Doe' },
            unreadMessageCount: 1,
            lastUpdated: new Date(2014, 1, 23),
            status: 'active',
            price: 0,
            addons: [],
            messages: [
              {
                from: 'John Doe',
                date: new Date(2014, 1, 23),
                body: "Hi!",
                attachments: []
              }
            ]
          },
          {
            title: 'Commission Title Here',
            buyer: { name: 'Jane Doe' },
            unreadMessageCount: 1,
            lastUpdated: new Date(2014, 1, 11),
            status: 'active',
            price: 0,
            addons: [],
            messages: [
              {
                from: 'John Doe',
                date: new Date(2014, 1, 23),
                body: "Boop!",
                attachments: []
              }
            ]
          },
          {
            title: 'Vowel porn',
            buyer: { name: 'Carol Vordamon' },
            unreadMessageCount: 0,
            lastUpdated: new Date(2013, 11, 5),
            status: 'active',
            price: 0,
            addons: [],
            messages: [
              {
                from: 'John Doe',
                date: new Date(2014, 1, 23),
                body: "Yes!",
                attachments: []
              }
            ]
          },
          {
            title: 'Advertisement',
            buyer: { name: 'Charleston Chew' },
            unreadMessageCount: 1,
            lastUpdated: new Date(2013, 1, 23),
            status: 'request',
            price: 0,
            addons: [],
            messages: [
              {
                from: 'John Doe',
                date: new Date(2014, 1, 23),
                body: "No!",
                attachments: []
              }
            ]          
          },
          {
            title: 'Sanic',
            buyer: { name: 'Knuckles' },
            unreadMessageCount: 1,
            lastUpdated: new Date(2013, 1, 23),
            status: 'request',
            price: 0,
            addons: [],
            messages: [
              {
                from: 'John Doe',
                date: new Date(2014, 1, 23),
                body: "Maybe, I don't know, can you repeat, the, question?",
                attachments: []
              }
            ]
          },
        ];
      });
    </script>
	</body>
</html>